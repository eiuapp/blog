<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-01-08 Fri 15:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>swift</title>
<meta name="generator" content="Org mode" />
<link rel="stylesheet" title="Standard" href="/html/style/worg.css" type="text/css" />
<link rel="alternate stylesheet" title="Zenburn" href="/html/style/worg-zenburn.css" type="text/css" />
<link rel="alternate stylesheet" title="Classic" href="/html/style/worg-classic.css" type="text/css" />
<link rel="SHORTCUT ICON" href="/html/style/org-mode-unicorn.ico" type="image/x-icon" />
<link rel="icon" href="/html/style/org-mode-unicorn.ico" type="image/ico" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded',function() {
      document.getElementById("table-of-contents").onclick = function() {
          var elem = document.getElementById("text-table-of-contents");
          elem.style.display = elem.style.display == "block" ? "none" : "block";
      }
  });

  var url = document.location.href;
  var orgsource = url.substring(0, url.lastIndexOf("."))+".org.html";
  function show_org_source(){
      document.location.href = orgsource;
  }
</script>

<script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, '//stats.orgmode.org/tracker.js', 'fathom');
fathom('set', 'siteId', 'NWSQJ');
fathom('trackPageview');
</script>
</div>
<div id="content">
<h1 class="title">swift</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3265e7b">Post</a>
<ul>
<li><a href="#org90b6ba4">swift doc.openstack translation</a>
<ul>
<li><a href="#orgbd581ad">openstack swift overview replication</a></li>
<li><a href="#orgaaf49c6">openstack swift overvice ring</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3265e7b" class="outline-2">
<h2 id="org3265e7b">Post</h2>
<div class="outline-text-2" id="text-org3265e7b">
</div>
<div id="outline-container-org90b6ba4" class="outline-3">
<h3 id="org90b6ba4">swift doc.openstack translation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="_swift">@swift</span>&#xa0;<span class="swift">swift</span></span></h3>
<div class="outline-text-3" id="text-org90b6ba4">
</div>
<div id="outline-container-orgbd581ad" class="outline-4">
<h4 id="orgbd581ad">openstack swift overview replication</h4>
<div class="outline-text-4" id="text-orgbd581ad">
</div>
</div>



<div id="outline-container-orgaaf49c6" class="outline-4">
<h4 id="orgaaf49c6">openstack swift overvice ring</h4>
<div class="outline-text-4" id="text-orgaaf49c6">
</div>


<ul class="org-ul">
<li><a id="org89f503a"></a>list of devices<br />
<div class="outline-text-5" id="text-org89f503a">
<p>
<a href="https://docs.openstack.org/swift/queens/overview_ring.html#list-of-devices">https://docs.openstack.org/swift/queens/overview_ring.html#list-of-devices</a>
</p>

<p>
这里的 list of devices 可以通过下面方式，查看得到。
</p>

<div class="org-src-container">
<pre class="src src-shell">root@controller:~/tmp2# cp /etc/swift/account.ring.gz  .
root@controller:~/tmp2# gzip -d ./account.ring.gz
gzip: ./account.ring already exists; <span style="color: #00bfff;">do</span> you wish to overwrite (y or n)? y
root@controller:~/tmp2# tail account.ring                                                                                                                                                                           R1NG<span style="color: #daa520;">"byteorder"</span>: <span style="color: #daa520;">"little"</span>, <span style="color: #daa520;">"devs"</span>: [{<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 0, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.134"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.134"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, null, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 2, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.127"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.127"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 3, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.198"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.198"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 4, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.180"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.180"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 5, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.135"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.135"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}], <span style="color: #daa520;">"part_shift"</span>: 22, <span style="color: #daa520;">"replica_count"</span>: 3}root@controller:~/tmp2#
R1NG{<span style="color: #daa520;">"byteorder"</span>: <span style="color: #daa520;">"little"</span>, <span style="color: #daa520;">"devs"</span>: [{<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 0, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.134"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.134"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, null, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 2, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.127"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.127"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 3, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.198"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.198"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 4, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.180"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.180"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}, {<span style="color: #daa520;">"device"</span>: <span style="color: #daa520;">"sdb"</span>, <span style="color: #daa520;">"id"</span>: 5, <span style="color: #daa520;">"ip"</span>: <span style="color: #daa520;">"192.168.0.135"</span>, <span style="color: #daa520;">"meta"</span>: <span style="color: #daa520;">""</span>, <span style="color: #daa520;">"port"</span>: 6202, <span style="color: #daa520;">"region"</span>: 1, <span style="color: #daa520;">"replication_ip"</span>: <span style="color: #daa520;">"192.168.0.135"</span>, <span style="color: #daa520;">"replication_port"</span>: 6202, <span style="color: #daa520;">"weight"</span>: 100.0, <span style="color: #daa520;">"zone"</span>: 1}], <span style="color: #daa520;">"part_shift"</span>: 22, <span style="color: #daa520;">"replica_count"</span>: 3}root@controller:~/tmp2#
  root@controller:~/tmp2#
</pre>
</div>

<p>
格式化一下json，如下
</p>

<div class="org-src-container">
<pre class="src src-json">{
	"byteorder": "little",
	"devs": [{
		"device": "sdb",
		"id": 0,
		"ip": "192.168.0.134",
		"meta": "",
		"port": 6202,
		"region": 1,
		"replication_ip": "192.168.0.134",
		"replication_port": 6202,
		"weight": 100.0,
		"zone": 1
	}, null, {
		"device": "sdb",
		"id": 2,
		"ip": "192.168.0.127",
		"meta": "",
		"port": 6202,
		"region": 1,
		"replication_ip": "192.168.0.127",
		"replication_port": 6202,
		"weight": 100.0,
		"zone": 1
	}, {
		"device": "sdb",
		"id": 3,
		"ip": "192.168.0.198",
		"meta": "",
		"port": 6202,
		"region": 1,
		"replication_ip": "192.168.0.198",
		"replication_port": 6202,
		"weight": 100.0,
		"zone": 1
	}, {
		"device": "sdb",
		"id": 4,
		"ip": "192.168.0.180",
		"meta": "",
		"port": 6202,
		"region": 1,
		"replication_ip": "192.168.0.180",
		"replication_port": 6202,
		"weight": 100.0,
		"zone": 1
	}, {
		"device": "sdb",
		"id": 5,
		"ip": "192.168.0.135",
		"meta": "",
		"port": 6202,
		"region": 1,
		"replication_ip": "192.168.0.135",
		"replication_port": 6202,
		"weight": 100.0,
		"zone": 1
	}],
	"part_shift": 22,
	"replica_count": 3
}
</pre>
</div>
</div>
</li>


<li><a id="orged7c75d"></a>building the ring<br />
<div class="outline-text-5" id="text-orged7c75d">
<p>
<a href="https://docs.openstack.org/swift/queens/overview_ring.html#building-the-ring">https://docs.openstack.org/swift/queens/overview_ring.html#building-the-ring</a>
</p>

<div class="org-src-container">
<pre class="src src-text">First the ring builder calculates the replicanths wanted at each tier in the ring&#8217;s topology based on weight.

Then the ring builder calculates the replicanths wanted at each tier in the ring&#8217;s topology based on dispersion.

Then the ring builder calculates the maximum deviation on a single device between its weighted replicanths and wanted replicanths.

Next we interpolate between the two replicanth values (weighted &amp; wanted) at each tier using the specified overload (up to the maximum required overload). It&#8217;s a linear interpolation, similar to solving for a point on a line between two points - we calculate the slope across the max required overload and then calculate the intersection of the line with the desired overload. This becomes the target.

From the target we calculate the minimum and maximum number of replicas any partition may have in a tier. This becomes the replica-plan.

Finally, we calculate the number of partitions that should ideally be assigned to each device based the replica-plan.

On initial balance (i.e., the first time partitions are placed to generate a ring) we must assign each replica of each partition to the device that desires the most partitions excluding any devices that already have their maximum number of replicas of that partition assigned to some parent tier of that device&#8217;s failure domain.

When building a new ring based on an old ring, the desired number of partitions each device wants is recalculated from the current replica-plan. Next the partitions to be reassigned are gathered up. Any removed devices have all their assigned partitions unassigned and added to the gathered list. Any partition replicas that (due to the addition of new devices) can be spread out for better durability are unassigned and added to the gathered list. Any devices that have more partitions than they now desire have random partitions unassigned from them and added to the gathered list. Lastly, the gathered partitions are then reassigned to devices using a similar method as in the initial assignment described above.

Whenever a partition has a replica reassigned, the time of the reassignment is recorded. This is taken into account when gathering partitions to reassign so that no partition is moved twice in a configurable amount of time. This configurable amount of time is known internally to the RingBuilder class as min_part_hours. This restriction is ignored for replicas of partitions on devices that have been removed, as device removal should only happens on device failure and there&#8217;s no choice but to make a reassignment.

The above processes don&#8217;t always perfectly rebalance a ring due to the random nature of gathering partitions for reassignment. To help reach a more balanced ring, the rebalance process is repeated a fixed number of times until the replica-plan is fulfilled or unable to be fulfilled (indicating we probably can&#8217;t get perfect balance due to too many partitions recently moved).
</pre>
</div>

<p>
翻译如下：
</p>

<div class="org-src-container">
<pre class="src src-text">&#39318;&#20808;&#65292;ring builder &#26681;&#25454;weight&#35745;&#31639; &#29615;&#30340;&#25299;&#25169;&#20013;&#27599;&#23618;&#25152;&#38656;&#30340; replicanths&#12290;

&#28982;&#21518;&#65292;ring builder &#26681;&#25454;dispersion&#35745;&#31639; &#29615;&#24418;&#25299;&#25169;&#20013;&#27599;&#23618;&#25152;&#38656;&#30340; replicanths&#12290;

&#28982;&#21518;&#65292;ring builder &#35745;&#31639;&#21333;&#20010;&#35774;&#22791;&#22312;&#20854;weighted replicanths&#21644;wanted replicanths&#20043;&#38388;&#30340;&#26368;&#22823;&#20559;&#24046;&#12290;

&#25509;&#19979;&#26469;&#65292;&#25105;&#20204;&#20351;&#29992;&#25351;&#23450;&#30340;&#36807;&#36733;&#65288;&#30452;&#21040;&#26368;&#22823;&#25152;&#38656;&#30340;&#36807;&#36733;&#65289;&#22312;&#27599;&#23618;&#30340;&#20004;&#20010;replicanth&#20540;&#65288;weighted &amp; wanted&#65289;&#20043;&#38388;&#36827;&#34892;&#25554;&#20540;&#12290;&#36825;&#26159;&#19968;&#20010;&#32447;&#24615;&#25554;&#20540;&#65292;&#31867;&#20284;&#20110;&#27714;&#35299;&#20004;&#28857;&#20043;&#38388;&#30340;&#30452;&#32447;&#19978;&#30340;&#28857; - &#25105;&#20204;&#35745;&#31639;max required overload&#30340;&#26012;&#29575;&#65292;&#28982;&#21518;&#35745;&#31639;&#35813;&#32447;&#19982;desired overload&#30340;&#20132;&#28857;&#12290;&#36825;&#25104;&#20026;&#30446;&#26631;&#12290;

&#20174;&#30446;&#26631;, &#25105;&#20204;&#35745;&#31639; &#22312;&#23618;&#20013;&#30340; any partition &#21487;&#33021;&#20855;&#26377;&#30340;&#26368;&#23567;&#21644;&#26368;&#22823;replicas&#25968;&#12290;&#36825;&#25104;&#20026;replica-plan&#12290;

Finally, we calculate the number of partitions that should ideally be assigned to each device based the replica-plan.

On initial balance&#65288;&#21363;&#65292;&#31532;&#19968;&#27425;&#25918;&#32622;&#20998;&#21306;&#20197;&#29983;&#25104;&#29615;&#65289;&#26102;&#65292;&#25105;&#20204;&#24517;&#39035;&#23558;&#27599;&#20010;&#20998;&#21306;&#30340;&#27599;&#20010;&#21103;&#26412;&#20998;&#37197;&#32473;&#38656;&#35201;&#26368;&#22810;&#20998;&#21306;&#30340;&#35774;&#22791;&#65292;&#19981;&#21253;&#25324;&#24050;&#20998;&#37197;&#32473;&#26576;&#20123;&#20998;&#21306;&#30340;&#26368;&#22823;&#20998;&#21306;&#21103;&#26412;&#25968;&#30340;&#35774;&#22791;&#35813;&#35774;&#22791;&#30340;&#25925;&#38556;&#22495;&#30340;&#29238;&#23618;&#12290;

&#24403;&#22522;&#20110;&#26087;&#29615;&#32780;&#24314;&#31435;&#26032;&#29615;&#26102;&#65292;&#20174;&#24403;&#21069;replica-plan&#37325;&#26032;&#35745;&#31639;&#27599;&#20010;&#35774;&#22791;&#25152;&#38656;&#30340;&#20998;&#21306;&#25968;&#12290;&#25509;&#19979;&#26469;&#65292;&#23558;&#25910;&#38598;&#35201;&#37325;&#26032;&#20998;&#37197;&#30340;&#20998;&#21306;&#12290;&#20219;&#20309;&#24050;&#21024;&#38500;&#30340;&#35774;&#22791;&#37117;&#20250;&#23558;&#25152;&#26377;&#24050;&#20998;&#37197;&#30340;&#20998;&#21306;&#21462;&#28040;&#20998;&#37197;&#24182;&#28155;&#21152;&#21040;gathered list&#20013;&#12290;&#20219;&#20309;&#20998;&#21306;&#21103;&#26412;&#65288;&#30001;&#20110;&#28155;&#21152;&#20102;&#26032;&#35774;&#22791;&#65289;&#21487;&#20197;&#34987;&#20998;&#25955;&#20197;&#33719;&#24471;&#26356;&#22909;&#30340;&#25345;&#20037;&#24615;&#65292;&#36825;&#20123;&#21103;&#26412;&#26159;&#26410;&#20998;&#37197;&#30340;&#65292;&#20250;&#28155;&#21152;&#21040;gathered list&#20013;&#12290;&#20219;&#20309;&#20855;&#26377;&#27604;&#29616;&#22312;&#26356;&#22810;&#20998;&#21306;&#30340;&#35774;&#22791;&#37117;&#20250;&#20174;&#23427;&#20204;&#20013;&#21462;&#28040;&#20998;&#37197;&#38543;&#26426;&#20998;&#21306;&#65292;&#24182;&#28155;&#21152;&#21040;gathered list&#20013;&#12290;&#26368;&#21518;&#65292;&#20351;&#29992;&#19982;&#19978;&#36848;&#21021;&#22987;&#20998;&#37197;&#20013;&#31867;&#20284;&#30340;&#26041;&#27861;&#65292;&#23558;&#25910;&#38598;&#30340;&#20998;&#21306;&#37325;&#26032;&#20998;&#37197;&#32473;&#35774;&#22791;&#12290;

&#27599;&#24403;&#20998;&#21306;&#37325;&#26032;&#20998;&#37197;&#21103;&#26412;&#26102;&#65292;&#37117;&#20250;&#35760;&#24405;&#37325;&#26032;&#20998;&#37197;&#30340;&#26102;&#38388;&#12290;&#22312;&#25910;&#38598;&#20998;&#21306;&#20197;&#37325;&#26032;&#20998;&#37197;&#26102;&#20250;&#32771;&#34385;&#36825;&#19968;&#28857;&#65292;&#20197;&#20415;&#22312;&#21487;&#37197;&#32622;&#30340;&#26102;&#38388;&#20869;&#19981;&#20250;&#31227;&#21160;&#20998;&#21306;&#20004;&#27425;&#12290;&#36825;&#20010;&#21487;&#37197;&#32622;&#30340;&#26102;&#38388;&#37327;&#22312;RingBuilder&#31867;&#20869;&#37096;&#31216;&#20026;min_part_hours&#12290;&#23545;&#20110;&#24050;&#21024;&#38500;&#30340;&#35774;&#22791;&#19978;&#30340;&#20998;&#21306;&#21103;&#26412;&#65292;&#23558;&#24573;&#30053;&#27492;&#38480;&#21046;&#65292;&#22240;&#20026;&#35774;&#22791;&#21024;&#38500;&#24212;&#20165;&#22312;&#35774;&#22791;&#25925;&#38556;&#26102;&#21457;&#29983;&#65292;&#24182;&#19988;&#38500;&#20102;&#36827;&#34892;&#37325;&#26032;&#20998;&#37197;&#20043;&#22806;&#21035;&#26080;&#36873;&#25321;&#12290;

&#30001;&#20110;&#25910;&#38598;&#20998;&#21306;&#29992;&#20110;&#37325;&#26032;&#20998;&#37197;&#30340;&#38543;&#26426;&#24615;&#36136;&#65292;&#19978;&#36848;&#36807;&#31243;&#24182;&#19981;&#24635;&#26159;&#33021;&#23436;&#32654;&#22320;rebalance a ring&#12290;&#20026;&#20102;&#24110;&#21161;reach a more balanced ring&#65292;&#37325;&#26032;&#24179;&#34913;&#36807;&#31243;&#37325;&#22797;&#22266;&#23450;&#27425;&#25968;&#65292;until replica-plan is fulfilled or unable to be fulfilled&#65288;&#34920;&#26126;, &#30001;&#20110;&#26368;&#36817;&#31227;&#21160;&#30340;&#20998;&#21306;&#22826;&#22810;&#65292;&#25105;&#20204;&#21487;&#33021;&#26080;&#27861;&#33719;&#24471; perfect balance&#65289;&#12290;
</pre>
</div>

<p>
这里是对
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
